(this["webpackJsonpmessenger-client"]=this["webpackJsonpmessenger-client"]||[]).push([[0],{32:function(e,t,n){},34:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var r,a=n(1),c=n(0),s=n.n(c),o=n(13),i=n.n(o),u=(n(32),n(5)),l=n(8),j=n(2),b=n.n(j),m=n(4),p=n(3),d=n(14),h=(n(34),function(e){return e.to?Object(a.jsx)(l.b,{to:e.to,exact:e.exact,className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),children:e.children}):Object(a.jsx)("button",{className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),type:e.type,onClick:e.onClick,disabled:e.disabled,children:e.children})}),O=function(e){var t="input"===e.element?Object(a.jsx)("input",{name:e.name,ref:e.valRef,type:e.type,defaultValue:e.dv,value:e.val}):Object(a.jsx)("textarea",{rows:e.rows||3,ref:e.valRef,name:e.name,value:e.val});return Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{children:e.label})," ",Object(a.jsx)("br",{}),t]})},f=(n(40),function(e){return Object(a.jsx)("div",{className:"card ".concat(e.className),style:e.style,children:e.children})}),g=n(24),x=n(51),v=(n(41),function(e){var t=Object(a.jsxs)("div",{className:"modal ".concat(e.className),style:e.style,children:[Object(a.jsx)("header",{className:"modal__header ".concat(e.headerClass),children:Object(a.jsx)("h2",{children:e.header})}),Object(a.jsxs)("form",{onSubmit:e.onSubmit?e.onSubmit:function(e){return e.preventDefault()},children:[Object(a.jsx)("div",{className:"modal__content ".concat(e.contentClass),children:e.children}),Object(a.jsx)("footer",{className:"modal__footer ".concat(e.footerClass),children:e.footer})]})]});return i.a.createPortal(t,document.getElementById("modal-hook"))}),k=function(e){return Object(a.jsx)(x.a,{in:e.show,mountOnEnter:!0,unmountOnExit:!0,timeout:200,classNames:"modal",children:Object(a.jsx)(v,Object(g.a)({},e))})},y=function(e){return Object(a.jsx)(k,{onCancel:e.onClear,header:"An Error Occurred!",show:!!e.error,footer:Object(a.jsx)(h,{onClick:e.onClear,children:" okay "}),children:Object(a.jsx)("p",{children:e.error})})},w=(n(42),function(e){return Object(a.jsx)("div",{className:"".concat(e.asOverlay&&"loading-spinner__overlay"),children:Object(a.jsx)("div",{className:"lds-dual-ring"})})}),S=Object(c.createContext)({isLoggedIn:!1,userId:null,login:function(){},logout:function(){}}),C=function(){var e=Object(c.useState)(!1),t=Object(p.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(),s=Object(p.a)(a,2),o=s[0],i=s[1],u=Object(c.useRef)([]),l=Object(c.useCallback)(function(){var e=Object(m.a)(b.a.mark((function e(t){var n,a,c,s,o,l,j=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j.length>1&&void 0!==j[1]?j[1]:"GET",a=j.length>2&&void 0!==j[2]?j[2]:null,c=j.length>3&&void 0!==j[3]?j[3]:{},r(!0),s=new AbortController,u.current.push(s),e.prev=6,e.next=9,fetch(t,{method:n,body:a,headers:c,signal:s.signal});case 9:return o=e.sent,e.next=12,o.json();case 12:if(l=e.sent,u.current=u.current.filter((function(e){return e!==s})),o.ok){e.next=16;break}throw new Error(l.message);case 16:return r(!1),e.abrupt("return",l);case 20:throw e.prev=20,e.t0=e.catch(6),i(e.t0.message),r(!1),e.t0;case 25:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(c.useEffect)((function(){return function(){u.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:n,error:o,sendRequest:l,clearError:function(){i(null)}}},N=(n(43),function(e){var t=Object(c.useState)(),n=Object(p.a)(t,2),r=n[0],s=n[1],o=Object(c.useState)(),i=Object(p.a)(o,2),u=i[0],j=i[1],d=Object(c.useState)(),h=Object(p.a)(d,2),O=h[0],g=h[1],x=C(),v=(x.isLoading,x.error,x.sendRequest);x.clearError;return Object(c.useEffect)((function(){(function(){var t=Object(m.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v("".concat("https://mongomessenger.herokuapp.com/api","/user/findemail/").concat(e.chat[0]));case 3:n=t.sent,s(n.user.email),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[v,e.chat]),Object(c.useEffect)((function(){(function(){var t=Object(m.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v("".concat("https://mongomessenger.herokuapp.com/api","/user/findemail/").concat(e.chat[1]));case 3:n=t.sent,j(n.user.email),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[v,e.chat]),Object(c.useEffect)((function(){(function(){var t=Object(m.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v("".concat("https://mongomessenger.herokuapp.com/api","/user/findemail/").concat(e.chat[2]));case 3:n=t.sent,g(n.user.email),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[v,e.chat]),Object(a.jsx)("li",{className:"mb-item",children:Object(a.jsxs)(f,{children:[" ",Object(a.jsx)(l.b,{to:"/".concat(e._id,"/messageboard"),children:Object(a.jsx)("div",{children:Object(a.jsxs)("div",{children:[r,Object(a.jsx)("br",{}),u,Object(a.jsx)("br",{}),O]})})})]})})}),I=(n(44),function(e){return Object(a.jsx)("ul",{className:"mb-list",children:e.items.map((function(e){return Object(a.jsx)(N,{_id:e._id,chat:e.chat},e._id)}))})}),E=function(){var e=Object(c.useContext)(S),t=Object(d.a)(),n=t.register,r=t.handleSubmit,o=Object(c.useState)(),i=Object(p.a)(o,2),l=i[0],j=i[1],g=Object(c.useState)(),x=Object(p.a)(g,2),v=x[0],k=x[1],N=Object(u.f)(),E=Object(c.useState)(),_=Object(p.a)(E,2),T=_[0],R=_[1],L=C(),D=L.isLoading,P=L.error,J=L.sendRequest,F=L.clearError,B=Object(u.g)().userId,q=function(){var t=Object(m.a)(b.a.mark((function t(n){var r,a,c,s,o,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==n.player1){t.next=21;break}return t.prev=1,t.next=4,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/getuserbyemail/").concat(n.player2));case 4:c=t.sent,r=c.user[0]._id,t.next=10;break;case 8:t.prev=8,t.t0=t.catch(1);case 10:return t.prev=10,t.next=13,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/createmb"),"POST",JSON.stringify({chat:[e.userId,r]}),{"Content-Type":"application/json",Authorization:"Bearer "+e.token});case 13:k(""),N.push("/"+B+"/messageboards"),t.next=19;break;case 17:t.prev=17,t.t1=t.catch(10);case 19:t.next=65;break;case 21:if(""!==n.player2){t.next=42;break}return t.prev=22,t.next=25,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/getuserbyemail/").concat(n.player1));case 25:s=t.sent,a=s.user[0]._id,t.next=31;break;case 29:t.prev=29,t.t2=t.catch(22);case 31:return t.prev=31,t.next=34,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/createmb"),"POST",JSON.stringify({chat:[e.userId,a]}),{"Content-Type":"application/json",Authorization:"Bearer "+e.token});case 34:j(""),N.push("/"+B+"/messageboards"),t.next=40;break;case 38:t.prev=38,t.t3=t.catch(31);case 40:t.next=65;break;case 42:return t.prev=42,t.next=45,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/getuserbyemail/").concat(n.player1));case 45:return o=t.sent,r=o.user[0]._id,t.next=49,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/getuserbyemail/").concat(n.player2));case 49:i=t.sent,a=i.user[0]._id,t.next=55;break;case 53:t.prev=53,t.t4=t.catch(42);case 55:return t.prev=55,t.next=58,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/createmb"),"POST",JSON.stringify({chat:[e.userId,r,a]}),{"Content-Type":"application/json",Authorization:"Bearer "+e.token});case 58:j(""),k(""),N.push("/"+B+"/messageboards"),t.next=65;break;case 63:t.prev=63,t.t5=t.catch(55);case 65:case"end":return t.stop()}}),t,null,[[1,8],[10,17],[22,29],[31,38],[42,53],[55,63]])})));return function(e){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){(function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J("".concat("https://mongomessenger.herokuapp.com/api","/messages/messageboards/").concat(B));case 3:t=e.sent,R(t.messageboards),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[J,B]),Object(a.jsxs)(s.a.Fragment,{children:[Object(a.jsx)(y,{error:P,onClear:F}),D&&Object(a.jsx)("div",{children:Object(a.jsx)(w,{})}),Object(a.jsx)(f,{children:Object(a.jsxs)("form",{onSubmit:r(q),children:[Object(a.jsx)(O,{element:"input",valRef:n,name:"player1",val:l}),Object(a.jsx)(O,{element:"input",valRef:n,name:"player2",val:v}),Object(a.jsx)(h,{children:"start messenging"})]})}),!D&&T&&Object(a.jsx)(I,{items:T})]})},_=function(e){var t=Object(c.useState)(),n=Object(p.a)(t,2),r=n[0],s=n[1],o=Object(c.useState)(),i=Object(p.a)(o,2),u=i[0],l=i[1],j=C(),d=(j.isLoading,j.error,j.sendRequest);j.clearError;return Object(c.useEffect)((function(){(function(){var t=Object(m.a)(b.a.mark((function t(){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d("".concat("https://mongomessenger.herokuapp.com/api","/messages/getmessages/").concat(e.messages));case 3:return n=t.sent,s(n.message.message),t.next=7,d("".concat("https://mongomessenger.herokuapp.com/api","/messages/findmessenger/").concat(e.messages));case 7:r=t.sent,l(r.message[0].name),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}})()()}),[d,e.messages]),Object(a.jsx)("li",{className:"mb-item",children:Object(a.jsx)(f,{children:Object(a.jsxs)("div",{children:[u," : ",r]})})})},T=(n(45),function(e){return Object(a.jsx)("ul",{className:"mb-list",children:e.stuff.map((function(e){return Object(a.jsx)(_,{messages:e},e)})).reverse()})}),R=function(){var e=Object(c.useContext)(S),t=Object(c.useState)(),n=Object(p.a)(t,2),r=n[0],o=n[1],i=Object(d.a)(),l=i.register,j=i.handleSubmit,g=C(),x=g.isLoading,v=g.error,k=g.sendRequest,N=g.clearError,I=Object(u.g)().mbId,E=Object(c.useState)(),_=Object(p.a)(E,2),R=_[0],L=_[1],D=function(){var t=Object(m.a)(b.a.mark((function t(n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k("".concat("https://mongomessenger.herokuapp.com/api","/messages/createMessage"),"POST",JSON.stringify({sender:e.userId,messageboard:I,message:n.messages,chat:[e.userId]}),{"Content-Type":"application/json",Authorization:"Bearer "+e.token});case 3:L(""),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:(function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k("".concat("https://mongomessenger.herokuapp.com/api","/messages/findmb/").concat(I));case 3:t=e.sent,o(t.messageboard.messages),console.log(t.messageboard),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()();case 11:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){(function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k("".concat("https://mongomessenger.herokuapp.com/api","/messages/findmb/").concat(I));case 3:t=e.sent,o(t.messageboard.messages),console.log(t.messageboard),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()()}),[k,I]),Object(a.jsxs)(s.a.Fragment,{children:[Object(a.jsx)(y,{error:v,onClear:N}),x&&Object(a.jsx)("div",{children:Object(a.jsx)(w,{})}),Object(a.jsx)("div",{children:Object(a.jsx)(f,{children:Object(a.jsxs)("form",{onSubmit:j(D),children:[Object(a.jsx)(O,{valRef:l,name:"messages",val:R}),Object(a.jsx)(h,{children:"message"})]})})}),!x&&r&&Object(a.jsx)(T,{stuff:r})]})},L=(n(46),function(e){return Object(a.jsx)("header",{className:"main-header",children:e.children})}),D=(n(47),function(){var e=Object(c.useContext)(S);return Object(a.jsxs)("ul",{className:"nav-links",children:[e.isLoggedIn&&Object(a.jsx)("li",{children:Object(a.jsx)(l.c,{to:"/".concat(e.userId,"/messageboards"),children:"messages"})}),!e.isLoggedIn&&Object(a.jsx)("li",{children:Object(a.jsx)(l.c,{to:"/auth",children:"login"})}),e.isLoggedIn&&Object(a.jsx)("li",{children:Object(a.jsx)("button",{onClick:e.logout,children:"LOGOUT"})})]})}),P=(n(48),function(e){var t=Object(a.jsx)(x.a,{in:e.show,timeout:200,classNames:"slide-in-left",mountOnEnter:!0,unmountOnExit:!0,children:Object(a.jsx)("aside",{className:"side-drawer",onClick:e.onClick,children:e.children})});return i.a.createPortal(t,document.getElementById("drawer-hook"))}),J=(n(49),function(){var e=Object(c.useState)(!1),t=Object(p.a)(e,2),n=t[0],r=t[1];return Object(a.jsxs)(s.a.Fragment,{children:[Object(a.jsx)(P,{show:n,onClick:function(){r(!1)},children:Object(a.jsx)("nav",{className:"main-navigation__drawer-nav",children:Object(a.jsx)(D,{})})}),Object(a.jsxs)(L,{children:[Object(a.jsxs)("button",{className:"main-navigation__menu-btn",onClick:function(){r(!0)},children:[Object(a.jsx)("span",{}),Object(a.jsx)("span",{})," ",Object(a.jsx)("span",{})]}),Object(a.jsx)("nav",{className:"main-navigation__header-nav",children:Object(a.jsx)(D,{})})]})]})}),F=function(){var e=Object(c.useContext)(S),t=C(),n=t.isLoading,r=t.error,o=t.sendRequest,i=t.clearError,u=Object(d.a)(),j=u.register,p=u.handleSubmit,g=function(){var t=Object(m.a)(b.a.mark((function t(n){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o("https://mongomessenger.herokuapp.com/api/user/login","POST",JSON.stringify({email:n.login,password:n.password}),{"Content-Type":"application/json"});case 3:r=t.sent,e.login(r.userId,r.token),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)(s.a.Fragment,{children:[Object(a.jsx)(y,{error:r,onClear:i}),Object(a.jsxs)(f,{className:"authentication",children:[n&&Object(a.jsx)(w,{asOverlay:!0}),Object(a.jsx)("h2",{children:"please login"}),Object(a.jsxs)("form",{onSubmit:p(g),children:[Object(a.jsx)(O,{name:"login",valRef:j,label:"email",element:"input"}),Object(a.jsx)(O,{name:"password",valRef:j,label:"password",element:"input"}),"did you mean to ",Object(a.jsx)(l.b,{to:"/signup",children:" signup "})," ",Object(a.jsx)("br",{}),Object(a.jsx)(h,{type:"submit",children:"login"})]})]})]})},B=function(){var e=Object(c.useContext)(S),t=Object(d.a)(),n=t.register,r=t.handleSubmit,o=C(),i=o.isLoading,u=o.error,l=o.sendRequest,j=o.clearError,p=function(){var t=Object(m.a)(b.a.mark((function t(n){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l("https://mongomessenger.herokuapp.com/api/user/signup","POST",JSON.stringify({name:n.name,email:n.email,password:n.password}),{"Content-Type":"application/json"});case 3:r=t.sent,e.login(r.userId,r.token),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)(s.a.Fragment,{children:[Object(a.jsx)(y,{error:u,onClear:j}),Object(a.jsxs)(f,{children:[i&&Object(a.jsx)(w,{asOverylay:!0}),Object(a.jsxs)("form",{onSubmit:r(p),children:[Object(a.jsx)(O,{name:"name",valRef:n,label:"name",element:"input"}),Object(a.jsx)(O,{name:"email",valRef:n,label:"email",element:"input"}),Object(a.jsx)(O,{name:"password",valRef:n,label:"password",element:"input",type:"password"}),Object(a.jsx)(h,{type:"submit",children:"submit"})]})]})]})},q=function(){var e,t=function(){var e=Object(c.useState)(!1),t=Object(p.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(),o=Object(p.a)(s,2),i=o[0],u=o[1],l=Object(c.useState)(!1),j=Object(p.a)(l,2),b=j[0],m=j[1],d=Object(c.useCallback)((function(e,t,n){a(t),m(e);var r=n||new Date((new Date).getTime()+36e5);u(r),localStorage.setItem("userData",JSON.stringify({userId:e,token:t,expiration:r.toISOString()}))}),[]),h=Object(c.useCallback)((function(){a(null),u(null),m(null),localStorage.removeItem("userData")}),[]);return Object(c.useEffect)((function(){if(n&&i){var e=i.getTime()-(new Date).getTime();r=setTimeout(h,e)}else clearTimeout(r)}),[n,h,i]),Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&new Date(e.expiration)>new Date&&d(e.userId,e.token,new Date(e.expiration))}),[d]),{token:n,login:d,logout:h,userId:b}}(),n=t.token,s=t.login,o=t.logout,i=t.userId;return e=n?Object(a.jsxs)(u.c,{children:[Object(a.jsx)(u.a,{path:"/:userId/messageboards",children:Object(a.jsx)(E,{})}),Object(a.jsx)(u.a,{path:"/:mbId/messageboard",children:Object(a.jsx)(R,{})})]}):Object(a.jsxs)(u.c,{children:[Object(a.jsx)(u.a,{path:"/auth",children:Object(a.jsx)(F,{})}),Object(a.jsx)(u.a,{path:"/signup",children:Object(a.jsx)(B,{})})]}),Object(a.jsx)(S.Provider,{value:{isLoggedIn:!!n,token:n,userId:i,login:s,logout:o},children:Object(a.jsxs)(l.a,{children:[Object(a.jsx)(J,{}),Object(a.jsx)("main",{children:e})]})})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,52)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};i.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(q,{})}),document.getElementById("root")),z()}},[[50,1,2]]]);
//# sourceMappingURL=main.c32ad849.chunk.js.map